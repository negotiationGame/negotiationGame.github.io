<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://pro.fontawesome.com/releases/v5.10.0/css/all.css" integrity="sha384-AYmEC3Yw5cVb3ZcuHtOA93w35dYTsvhLPVnYs9eStHfGJvOvKxVfELGroGkvsg+p" crossorigin="anonymous"/>

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-F3w7mX95PdgyTmZZMECAngseQB83DfGTowi0iMjiWaeVhAn4FJkqJByhZMI3AhiU" crossorigin="anonymous">

    <title>TheNegotiationGame</title>
  </head>
  <body>


<div class="accordion" id="accordionExample">
  <div class="accordion-item">
    <h2 class="accordion-header" id="headingOne">
      <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
        <b>Hide it all</b>
      </button>
    </h2>
    <div id="collapseOne" class="accordion-collapse collapse show" aria-labelledby="headingOne" data-bs-parent="#accordionExample">
        <center>Everything's safe</center>
        <center>Are you ready to go at it again?</center>
    </div>
  </div>
  <div class="accordion-item">
    <h2 class="accordion-header" id="headingTwo" onclick="init_buyer()">
      <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
        <b>Buyer</b>
      </button>
    </h2>
    <div id="collapseTwo" class="accordion-collapse collapse" aria-labelledby="headingTwo" data-bs-parent="#accordionExample">
      <div class="accordion-body">
        <form>
          <div class="input-group flex-nowrap">
            <span class="input-group-text bg-primary">M</span>
            <span id="lb-buyer-01" class="input-group-text bg-primary"></span>
            <input id="in-buyer-01" type="text" class="form-control" placeholder="" aria-label="" aria-describedby="lb-buyer-01">
          </div>
          <div class="input-group flex-nowrap">
            <span class="input-group-text"><i class="fas fa-coins"></i></span>
            <span id="lb-buyer-02" class="input-group-text bg-info"></span>
            <input id="in-buyer-02" type="text" class="form-control" placeholder="" aria-label="" aria-describedby="lb-buyer-02">
            <span class="input-group-text"><i class="fas fa-yen-sign"></i></span>
          </div>
          <div class="input-group flex-nowrap">
            <span class="input-group-text bg-warning">C</span>
            <span id="lb-buyer-03" class="input-group-text"></span>
            <input id="in-buyer-03" type="text" class="form-control" placeholder="" aria-label="" aria-describedby="lb-buyer-03">
          </div>
          <button type="button" class="btn btn-danger btn-block w-100 m-3" onclick="delete_buyer()">Hide Info</button>
          <div class="input-group flex-nowrap">
            <span class="input-group-text bg-danger">W</span>
            <span id="lb-buyer-04" class="input-group-text"></span>
            <input id="in-buyer-04" type="text" class="form-control" placeholder="" aria-label="" aria-describedby="lb-buyer-04">
          </div>
          <div class="input-group flex-nowrap">
            <span class="input-group-text bg-warning">C</span>
            <span id="lb-buyer-05" class="input-group-text"></span>
            <input id="in-buyer-05" type="text" class="form-control" placeholder="" aria-label="" aria-describedby="lb-buyer-05">
          </div>
          <div class="input-group flex-nowrap">
            <span class="input-group-text bg-success">S</span>
            <span id="lb-buyer-06" class="input-group-text"></span>
            <input id="in-buyer-06" type="text" class="form-control" placeholder="" aria-label="" aria-describedby="lb-buyer-06">
            <span class="input-group-text">units</span>
          </div>
        </form>
      </div>
    </div>
  </div>
  <div class="accordion-item">
    <h2 class="accordion-header" id="headingThree" onclick="init_seller()">
      <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
        <b>Seller</b>
      </button>
    </h2>
    <div id="collapseThree" class="accordion-collapse collapse" aria-labelledby="headingThree" data-bs-parent="#accordionExample">
      <div class="accordion-body">
        <form>
          <div class="input-group flex-nowrap">
            <span class="input-group-text bg-primary">M</span>
            <span id="lb-seller-01" class="input-group-text bg-primary"></span>
            <input id="in-seller-01" type="text" class="form-control" placeholder="" aria-label="" aria-describedby="lb-seller-01">
          </div>
          <div class="input-group flex-nowrap">
            <span class="input-group-text"><i class="fas fa-coins"></i></span>
            <span id="lb-seller-02" class="input-group-text bg-info"></span>
            <input id="in-seller-02" type="text" class="form-control" placeholder="" aria-label="" aria-describedby="lb-seller-02">
            <span class="input-group-text"><i class="fas fa-yen-sign"></i></span>
          </div>
          <div class="input-group flex-nowrap">
            <span class="input-group-text bg-warning">C</span>
            <span id="lb-seller-03" class="input-group-text"></span>
            <input id="in-seller-03" type="text" class="form-control" placeholder="" aria-label="" aria-describedby="lb-seller-03">
          </div>
          <button type="button" class="btn btn-danger btn-block w-100 m-3" onclick="delete_seller()">Hide Info</button>
          <div class="input-group flex-nowrap">
            <span class="input-group-text bg-danger">W</span>
            <span id="lb-seller-04" class="input-group-text"></span>
            <input id="in-seller-04" type="text" class="form-control" placeholder="" aria-label="" aria-describedby="lb-seller-04">
          </div>
          <div class="input-group flex-nowrap">
            <span class="input-group-text bg-warning">C</span>
            <span id="lb-seller-05" class="input-group-text"></span>
            <input id="in-seller-05" type="text" class="form-control" placeholder="" aria-label="" aria-describedby="lb-seller-05">
          </div>
          <div class="input-group flex-nowrap">
            <span class="input-group-text bg-success">S</span>
            <span id="lb-seller-06" class="input-group-text"></span>
            <input id="in-seller-06" type="text" class="form-control" placeholder="" aria-label="" aria-describedby="lb-seller-06">
            <span class="input-group-text">units</span>
          </div>
        </form>
      </div>
    </div>
  </div>
  <div class="accordion-item">
    <h2 class="accordion-header" id="headingFour" onclick="init_summary()">
      <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseFour" aria-expanded="false" aria-controls="collapseFour">
        <b>Summary</b>
      </button>
    </h2>
    <div id="collapseFour" class="accordion-collapse collapse" aria-labelledby="headingFour" data-bs-parent="#accordionExample">
      <div class="accordion-body">
        <form>
          <div class="input-group flex-nowrap">
            <span id="lb-summary-01" class="input-group-text"></span>
            <input id="in-summary-01" type="text" class="form-control" placeholder="" aria-label="" aria-describedby="lb-summary-01">
          </div>
          <div class="input-group flex-nowrap">
            <span id="lb-summary-02" class="input-group-text"></span>
            <input id="in-summary-02" type="text" class="form-control" placeholder="" aria-label="" aria-describedby="lb-summary-02">
          </div>
          <div class="input-group flex-nowrap">
            <span id="lb-summary-03" class="input-group-text"></span>
            <input id="in-summary-03" type="text" class="form-control" placeholder="" aria-label="" aria-describedby="lb-summary-03">
          </div>
          <div class="input-group flex-nowrap">
            <span id="lb-summary-04" class="input-group-text"></span>
            <input id="in-summary-04" type="text" class="form-control" placeholder="" aria-label="" aria-describedby="lb-summary-04">
          </div>
          <div class="input-group flex-nowrap">
            <span id="lb-summary-05" class="input-group-text"></span>
            <input id="in-summary-05" type="text" class="form-control" placeholder="" aria-label="" aria-describedby="lb-summary-05">
          </div>
          <div class="input-group flex-nowrap">
            <span id="lb-summary-06" class="input-group-text"></span>
            <input id="in-summary-06" type="text" class="form-control" placeholder="" aria-label="" aria-describedby="lb-summary-06">
          </div>
          <div class="input-group flex-nowrap">
            <span id="lb-summary-07" class="input-group-text"></span>
            <input id="in-summary-07" type="text" class="form-control" placeholder="" aria-label="" aria-describedby="lb-summary-07">
          </div>
          <div class="input-group flex-nowrap">
            <span id="lb-summary-08" class="input-group-text"></span>
            <input id="in-summary-08" type="text" class="form-control" placeholder="" aria-label="" aria-describedby="lb-summary-08">
          </div>
        </form>
      </div>
    </div>
  </div>
  <div class="accordion-item">
    <h2 class="accordion-header" id="headingFive" onclick="negotiate()">
      <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseFive" aria-expanded="false" aria-controls="collapseFive">
        <b>The 5 min timmer</b>
      </button>
    </h2>
    <div id="collapseFive" class="accordion-collapse collapse" aria-labelledby="headingFive" data-bs-parent="#accordionExample">
      <div class="accordion-body">
        <center>Negotiation closes in <h1><span id="time">05:00</span></h1></center>
      </div>
    </div>
  </div>
</div>

    <!-- Optional JavaScript; choose one of the two! -->

    <!-- Option 1: Bootstrap Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-/bQdsTh/da6pkI1MST/rWKFNjaCP5gBSY4sEBT38Q/9RBh9AH40zEOg7Hlq2THRZ" crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>

    <!-- Option 2: Separate Popper and Bootstrap JS -->
    <!--
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.3/dist/umd/popper.min.js" integrity="sha384-W8fXfP3gkOKtndU4JGtKDvXbO53Wy8SZCQHczT5FMiiqmQfUpWbYdTil/SxwZgAN" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/js/bootstrap.min.js" integrity="sha384-skAcpIdS7UcVUC05LJ9Dxay8AXcDYfBJqt1CJ85S/CFujBsIzCIv+l9liuYLaMQ/" crossorigin="anonymous"></script>
    -->
<script type="text/javascript">
function rX(dim){ return Math.floor((Math.random() * dim) + 1)}
function r10(){ return rX(10); }
function r100(){ return rX(100); }
function r1000(){ return rX(1000); }
function iChoose(items){ return items[Math.floor(Math.random()*items.length)]; }


function getTerm()      { return iChoose('30 Days,90 Days,15 Days,1 week,5 weeks'.split(',')); }
function getFrequency() { return iChoose('One off, Quarterly, Monthly, Yearly'.split(',')); }
function getType()      { return iChoose('Alfa,Bravo,Charlie,Delta,Echo,Foxtrot,Golf,Hotel,India,Juliett,Kilo,Lima,Mike,November,Oscar,Papa,Quebec,Romeo,Sierra,Tango,Uniform,Victor,Whiskey,X-ray,Yankee,Zulu'.split(',')); }
function getTechnique(str_in) {
  var arr_tech = []
  arr_tech.push("Assert:I can get it cheaper somewhere else...")
  arr_tech.push("Just say NO!")
  arr_tech.push("Moral Obligation:Is that the best you can do? <PAUSE> <REPLY> Is that really, the very best you can do?")
  arr_tech.push("Moral Obligation:Are you telling me that you've never sold that item for less than that amount? ever?")
  arr_tech.push("Low ball: 100 dollar -> I can give you 50 dollar, cash, right now! (Reduce inventory cost, CC Merchant fees, Instant gratification, etc.)")
  arr_tech.push("Expand: Use Open ended questions")
  arr_tech.push("Narrow: Use Closed ended questions. Yes/No")
  arr_tech.push("Flinch: non verbal")
  arr_tech.push("Flinch: audible")
  arr_tech.push("Flinch: verbally")
  arr_tech.push("Nibble a tie, free delivery, a coffee")
  arr_tech.push("Summarize the Deal often")
  arr_tech.push("Pause, wait and analyse")
  arr_tech.push("Fair")
  arr_tech.push("Win-Win")
  arr_tech.push("I propose.., Does that seem fair to you?")
  arr_tech.push("Flinch: Does that seem fair to you?")
  arr_tech.push("Flinch: I'm shocked")
  arr_tech.push("Flinch: I'm disapointed")
  arr_tech.push("Flinch: That's not what I was expecting")
  
  var str_out = iChoose(arr_tech);
  while(str_out === str_in){
    str_out = iChoose(arr_tech);
  }
  return str_out
}

var global_timer;
//var global_buyer_timer;
//var global_seller_timer;
function clear_all(){
  clearInterval(global_timer);
  //clearInterval(global_buyer_timer);
  //clearInterval(global_seller_timer);
}
var global_summary_ctx={};

const ctx = {}
      ctx.val  = r1000()
      ctx.qty  = r1000()
const zero_ctx = {};
      zero_ctx['??????']=''
      zero_ctx['?????']=''
      zero_ctx['????']=''
      zero_ctx['???']=''
      zero_ctx['??']=''
      zero_ctx['?']=''
function update_view(o,str_key){
  var idx=0;
  Object.keys(o).forEach((o_key)=>{
    idx++;
    $('#lb-'+str_key+'-0'+idx).text( o_key );
    $('#in-'+str_key+'-0'+idx).val( o[o_key] );
    console.log(o_key + ' : ' + o[o_key])
  })
}

function init_summary(){
  zopa = global_summary_ctx['Buyer Budget']-global_summary_ctx['Seller Break Even']
  global_summary_ctx['..']='..'
  global_summary_ctx['ZOPA'] = zopa + ' possible agreements.'
  global_summary_ctx['Mid Point'] = (zopa/2) + ' coins.'
  update_view(global_summary_ctx ,'summary' );
}
function delete_buyer(){update_view(zero_ctx,'buyer')}
function init_buyer(){
  var buyer_ctx = {};
  buyer_ctx['Remember to:'] = getTechnique(global_summary_ctx['Seller Practice']) ;
  buyer_ctx['Budget']       = ctx.val + Math.floor(ctx.val*Math.random()) ;
  buyer_ctx['Type']         = getType() ;
  buyer_ctx['Invoice Term'] = getTerm() ;
  buyer_ctx['Frequency']    = getFrequency() ;
  buyer_ctx['Quantity']     = ctx.qty + Math.floor(ctx.qty*Math.random()) ;

  global_summary_ctx['Buyer Budget'] = buyer_ctx['Budget']
  global_summary_ctx['Buyer Practice'] = buyer_ctx['Remember to:']
  global_summary_ctx['-'] = '-'

  /* ************************************************************** */

  update_view(buyer_ctx ,'buyer' );
  //global_buyer_timer = setTimeout( ()=>{update_view(zero_ctx,'buyer')}, 20*1000);
}
function delete_seller(){update_view(zero_ctx,'seller')}
function init_seller(){
  var seller_ctx = {};
  seller_ctx['Remember to:'] = getTechnique(global_summary_ctx['Buyer Practice']) ;
  seller_ctx['Break Even']   = ctx.val - Math.floor(ctx.val*Math.random());
  seller_ctx['Type']         = getType() ;
  seller_ctx['Invoice Term'] = getTerm() ;
  seller_ctx['Frequency']    = getFrequency() ;
  seller_ctx['Quantity']     = ctx.qty - Math.floor(ctx.qty*Math.random()) ;

  global_summary_ctx['Seller Practice'] = seller_ctx['Remember to:']
  global_summary_ctx['Seller Break Even'] = seller_ctx['Break Even']
  global_summary_ctx['-'] = '-'

  /* ************************************************************** */

  update_view(seller_ctx,'seller');
  //global_seller_timer = setTimeout( ()=>{update_view(zero_ctx,'seller')}, 20*1000);
}

function startTimer(duration, display) {
  clearInterval(global_timer);
  var start = Date.now(),
      diff,
      minutes,
      seconds;
  function timer() {
      // get the number of seconds that have elapsed since 
      // startTimer() was called
      diff = duration - (((Date.now() - start) / 1000) | 0);

      // does the same job as parseInt truncates the float
      minutes = (diff / 60) | 0;
      seconds = (diff % 60) | 0;

      minutes = minutes < 10 ? "0" + minutes : minutes;
      seconds = seconds < 10 ? "0" + seconds : seconds;

      display.textContent = minutes + ":" + seconds; 

      if (diff <= 0) {
          // add one second so that the count down starts at the full duration
          // example 05:00 not 04:59
          start = Date.now() + 1000;
      }
  };
  // we don't want to wait a full second before the timer starts
  timer();
  return setInterval(timer, 1000);
}

function negotiate() {
    var fiveMinutes = 60 * 5,
        display = document.querySelector('#time');
    global_timer = startTimer(fiveMinutes, display);
};

</script>
  </body>
</html>